{"version":3,"sources":["deect/index/index_button/core.cljs"],"mappings":";AAKA,IAAAA,iCAAA,qDAAAC;AAAA,AAAA,IAAAC,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;gBAAA,AAAAE,4CAAAF,eAAA,vEACIY;AADJ,AAEE,kBAAA;AAAA,OAEc,AAACC,MAAS,CAAA,+JAAA,5FAA4B,AAAA,gFAAKD,1JAC3C,8LAAA,WAAAE,zMACA,PAKA;AANA,AAAQ,OAAAA;SACD,WAAKC;AAAL,AACE,AAAUC,uBAAkB,AAAA,gFAAKJ,WAAWG;;AAC5C,OAACE,mDACAC,+BACA,WAAKC;AAAL,AAAQ,+DAAA,xDAACC,8CAAMR,iEAAiB,AAACS,wBAAWN;;UACtD;AAAA,AAAS,gHAAA,zGAACO;;;cATxB;AAAA,AAYU,IAAAC,qBAAmB,AAAUP,uBAAkB,AAAA,gFAAKJ;AAApD,AAAA,oBAAAW;AAAA,gBAAAA,ZAASC;AAAT,AACE,IAAA,AACE,OAACP,mDACAC,+BACA,WAAKC;AAAL,AAAQ,+DAAA,xDAACC,8CAAMR,iEAAiB,AAACS,wBAAWG;;gBAH/C,GAAA,CAAAC,kBAISC;AAJT,QAAAD,JAIwBN;AAJxB,AAI0B,OAACQ;;AAJ3B,AAAA,MAAAF;;;;AAKA,OAACE;;;AAlBb,AAAA,0FAAA,yDAAA,2CAAA,iMAAA,qDAAA,SAAA,vMAmBmB,CAAA,gBAAqB,AAACC,eAAK,AAAA,mFAAOhB,iJAE/BiB,gBACnB,AAAA,mFAAOjB;;AAxBZ,AAAA,6CAAA,AAAAT,4BAAA,qDAAAC,9HAAQO;AAAR,AAAA,IAAAN,0BAAA;AAAA,AAAA,CAAA,AAAAA,wCAAAP;;AAAA,AAAAQ,cAAAD,wBAAAD;;AAAA,OAAAG,yCAAAC,2DAAAH;;;AAAA,CAAA,+DAAA,/DAAQM;;AAAR,CAAA,yDAAA,zDAAQA;;AAAR,AAAAF,iEAAA,OAAA,iBAAAC,WAAA,EAAA,QAAA,eAAA,WAAA,lHAAQC;AAAR,AAAAD","names":["render-fn__11998__auto__","p__12073","map__12074","cljs.core/--destructure-map","cljs.core.get","reagent.impl.component/memo","jsprops__11999__auto__","jsprops2__12000__auto__","js/Object.assign","reagent.impl.component/functional-render","reagent.impl.template/*current-default-compiler*","js/Object.defineProperty","obj12080","deect.index.index-button.core/index-button","lang-item","js/fetch","p1__12072#","t","js/sessionStorage","cljs.core.swap_BANG_","deect.atoms/selected-lang-item","_","cljs.core.assoc","deect.utils/raw->map","cljs.core.println","temp__5802__auto__","raw-ccrec","e12076","js/SyntaxError","fetch-ccrec","cljs.core/name","handler"],"sourcesContent":["(ns deect.index.index-button.core\n  (:require [deect.atoms :as ats]\n            [deect.utils :as u]\n            [reagent.core :as r]))\n\n(r/defc index-button\n  [{lang-item :lang-item}]\n  (letfn [(fetch-ccrec\n            []\n            (-> (js/fetch (str \"data/code-coll-recs/\" (:id lang-item) \".json\"))\n                (.then #(.text %))\n                (.then (fn [t]\n                         (.setItem js/sessionStorage (:id lang-item) t)\n                         (swap!\n                          ats/selected-lang-item\n                          (fn [_] (assoc lang-item :ccrec (u/raw->map t))))))\n                (.catch #(println \"Couldn't fetch the selected record.\"))))\n          (handler\n            []\n            (if-let [raw-ccrec (.getItem js/sessionStorage (:id lang-item))]\n              (try\n                (swap!\n                 ats/selected-lang-item\n                 (fn [_] (assoc lang-item :ccrec (u/raw->map raw-ccrec))))\n                (catch js/SyntaxError _ (fetch-ccrec)))\n              (fetch-ccrec)))]\n    [:button {:class (str \"index-button \" (name (:type lang-item)))\n              :type \"button\"\n              :on-click handler}\n     (:name lang-item)]))\n"]}